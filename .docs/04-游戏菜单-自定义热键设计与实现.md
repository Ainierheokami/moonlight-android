## 游戏菜单「自定义热键」设计与实现

### 目标
- 在游戏菜单的「常用热键」区域，新增「自定义热键」能力：
  - 支持用户新增任意数量的热键项
  - 每个热键可自定义「名称」与「宏」
  - 执行逻辑复用虚拟键盘的宏系统（`MacroEditor`）

### 相关文件
- 布局：`app/src/main/res/layout/game_menu_overlay.xml`
  - 新增「自定义热键」分组标题、动态容器 `custom_hotkeys_container`、按钮 `btn_edit_hotkeys`
- 菜单逻辑：`app/src/main/java/com/limelight/heokami/GameMenuFragment.java`
  - 新增方法 `setupCustomHotkeysSection()`、`renderCustomHotkeysButtons()`
- 自定义热键管理器：`app/src/main/java/com/limelight/heokami/CustomHotkeysManager.java`
  - 负责增删改查、名称输入、宏编辑及执行
  - 存储使用 `SharedPreferences`（键：`custom_hotkeys_json`）
- 宏编辑与执行：`app/src/main/java/com/limelight/heokami/MacroEditor.kt`
  - 已有实现；通过 `OnMacroDataChangedListener` 回调保存
- 字符串资源：`app/src/main/res/values/strings.xml`
  - 新增「自定义热键」相关文案键

### 存储结构
`SharedPreferences("game_menu_prefs")` 中以 JSON 数组形式保存：
```json
[
  {
    "id": 1,
    "name": "我的热键",
    "actions": [
      { "type": "KEY_DOWN", "data": 65 },
      { "type": "KEY_UP",   "data": 65 }
    ]
  }
]
```

### 关键交互流程
- 点击「编辑热键」按钮：
  1) 隐藏菜单以避免层级冲突
  2) 打开管理对话框（列表/新增/重命名/删除/宏编辑）
  3) 宏编辑复用 `MacroEditor`，保存时回调 `OnMacroDataChangedListener`，将 `MACROS` 容器内宏序列化回 `actions`

- 渲染自定义热键列表：
  - 从偏好中读取所有自定义热键
  - 动态创建按钮加入 `custom_hotkeys_container`
  - 点击按钮：获取 `VirtualKeyboard` 实例，构造临时 `JSONObject`（含 `MACROS`），调用 `MacroEditor.runMacroAction()` 执行

### 复用与兼容性
- 复用宏体系：与虚拟键盘按钮 `ButtonType.HotKeys` 一致的执行路径
- 兼容宏存储升级：
  - `MacroEditor` 已实现宏与外观样式隔离（`MACROS` 容器）
  - 管理器在保存/解析时仅处理 `type/data` 对象，忽略非宏字段

### 注意事项
- 若 `VirtualKeyboard` 未初始化，`Game.getVirtualKeyboard()` 将懒加载构造；执行/编辑宏前需判空
- 当在「编辑热键」对话框中保存后，菜单可能已被关闭，UI刷新需判空 `getView()`（已在实现中处理）
- 字符串本地化：默认在 `values/strings.xml` 增加中文文案，可按需补充 `values-zh-rCN/strings.xml`

### 未来可扩展
- 支持导入/导出自定义热键集合
- 支持为自定义热键配置图标/颜色
- 支持排序与分组

